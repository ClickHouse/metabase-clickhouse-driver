info:
  name: Metabase ClickHouse Driver
  version: 1.1.7
  description: Allows Metabase to connect to ClickHouse databases.
contact-info:
  name: ClickHouse
  address: https://github.com/ClickHouse/metabase-clickhouse-driver
driver:
  name: clickhouse
  display-name: ClickHouse
  lazy-load: true
  parent: sql-jdbc
  connection-properties:
    - host
    - merge:
        - port
        - default: 8123
    - user
    - password
    - name: dbname
      display-name: Databases
      placeholder: default
      helper-text: "To specify multiple databases, separate them by the space symbol. For example: default data logs"
    - name: scan-all-databases
      display-name: Scan all databases
      type: boolean
      default: false
      description: Scan all tables from all available ClickHouse databases except the system ones.

    - ssl
    - ssh-tunnel
    - advanced-options-start
    - name: use-no-proxy
      display-name: Disable system wide proxy settings
      default: false
      type: boolean
      visible-if:
        advanced-options: true
    - name: use-has-token-for-contains
      display-name: Use hasToken instead of LIKE for :contains calls
      description: "If you call :contains only on columns with tokenbf_v1 indices,
        you could try enabling this option to improve the performance.
        Caution: enabling this option will alter ALL :contains calls
        which can cause false negatives with certain strings.
        For example, 'red' is not a token in a string 'Fred',
        and it will yield a negative result with hasToken,
        but LIKE %% (default behavior) will work as expected"
      default: false
      type: boolean
      visible-if:
        advanced-options: true
    - merge:
        - additional-options
        - placeholder: "connection_timeout=1000&max_rows_to_group_by=42"
    - default-advanced-options
  connection-properties-include-tunnel-config: true
init:
  - step: load-namespace
    namespace: metabase.driver.clickhouse
  - step: register-jdbc-driver
    class: com.clickhouse.jdbc.ClickHouseDriver
